# 容器型积木（C型积木）功能说明

## 概述

现在 `for循环` 和 `if语句` 积木已升级为**容器型积木**（C型积木），类似 Scratch 中的结构，可以包裹其他积木块。

## 主要改进

### 1. **for 循环积木**
- **参数**：
  - `循环变量`：例如 `i`（可修改）
  - `遍历`：例如 `1:10`（可修改为任何 R 表达式）
- **容器插槽**：`循环执行`
  - 可以拖拽任意积木到这个区域
  - 支持多个积木嵌套
  - 拖拽的积木会在循环体内执行

**使用示例**：
```r
for (i in 1:10) {
  print(i)
  print(i * 2)
}
```

### 2. **if 语句积木**
- **参数**：
  - `如果`：条件表达式，例如 `x > 0`（可修改）
- **容器插槽**：`那么执行`
  - 可以拖拽任意积木到这个区域
  - 支持多个积木嵌套
  - 只有条件成立时才执行

**使用示例**：
```r
if (x > 0) {
  print("x 是正数")
  print(x)
}
```

## 如何使用

### 拖拽积木到容器
1. 从左侧积木板拖拽 `for循环` 或 `if语句` 到画布
2. 拖拽其他积木（如 `print`、`赋值` 等）到容器的插槽区域
3. 松开鼠标，积木会自动嵌入到容器中
4. 容器内的积木会自动缩进显示

### 修改参数
- 点击容器积木，在右侧属性面板修改参数
- `for循环`：可以修改循环变量名和遍历范围
- `if语句`：可以修改判断条件
- 容器内的每个积木也可以独立修改参数

### 删除容器内的积木
- 点击容器内积木上的 ❌ 按钮即可删除

### 嵌套容器
- 支持多层嵌套，例如在 `for循环` 内放置另一个 `if语句`
- 代码会自动生成正确的缩进

## 技术实现

### 类型定义
- `BlockDefinition.isContainer`: 标记为容器型积木
- `BlockDefinition.slots`: 定义插槽（可以有多个）
- `BlockInstance.children`: 存储子积木 ID 列表
- `BlockInstance.parentId`: 指向父容器 ID

### 代码生成
- 使用 Handlebars 风格的模板引擎
- 支持 `{{#each children.slotName}}...{{/each}}` 循环
- 递归生成嵌套结构的代码

### 样式
- 插槽区域有虚线边框，提示拖拽区域
- 空插槽显示"拖拽积木到这里"提示
- 子积木自动缩进和对齐

## 优点

✅ **更直观**：像 Scratch 一样，可以看到代码块的嵌套结构  
✅ **更易用**：拖拽操作，不需要手动编写循环体  
✅ **更灵活**：参数可以随时修改，循环变量和条件都可自定义  
✅ **更强大**：支持多层嵌套，可以创建复杂的逻辑结构  

## 下一步计划

- [ ] 添加 `else` 分支到 `if语句`（双插槽容器）
- [ ] 添加 `while` 循环容器
- [ ] 添加函数定义容器
- [ ] 支持容器内积木的拖拽排序

---

**提示**：容器型积木的参数（循环变量、循环范围、条件）都可以在属性面板中修改，给您最大的灵活性！

